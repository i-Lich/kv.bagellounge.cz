!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.jStore=t():e.jStore=t()}(window,function(){return function(s){function e(e){for(var t,r,n=e[0],o=e[1],a=0,i=[];a<n.length;a++)r=n[a],Object.prototype.hasOwnProperty.call(u,r)&&u[r]&&i.push(u[r][0]),u[r]=0;for(t in o)Object.prototype.hasOwnProperty.call(o,t)&&(s[t]=o[t]);for(c&&c(e);i.length;)i.shift()()}var r={},u={0:0};function l(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return s[e].call(t.exports,t,t.exports,l),t.l=!0,t.exports}l.e=function(o){var e=[],r=u[o];if(0!==r)if(r)e.push(r[2]);else{var t=new Promise(function(e,t){r=u[o]=[e,t]});e.push(r[2]=t);var n,a=document.createElement("script");a.charset="utf-8",a.timeout=120,l.nc&&a.setAttribute("nonce",l.nc),a.src=l.p+"libs/"+o+".require.js";var i=new Error;n=function(e){a.onerror=a.onload=null,clearTimeout(s);var t=u[o];if(0!==t){if(t){var r=e&&("load"===e.type?"missing":e.type),n=e&&e.target&&e.target.src;i.message="Loading chunk "+o+" failed.\n("+r+": "+n+")",i.name="ChunkLoadError",i.type=r,i.request=n,t[1](i)}u[o]=void 0}};var s=setTimeout(function(){n({type:"timeout",target:a})},12e4);a.onerror=a.onload=n,document.head.appendChild(a)}return Promise.all(e)},l.m=s,l.c=r,l.d=function(e,t,r){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(l.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)l.d(r,n,function(e){return t[e]}.bind(null,n));return r},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="",l.oe=function(e){throw console.error(e),e};var t=window.webpackJsonpjStore=window.webpackJsonpjStore||[],n=t.push.bind(t);t.push=e,t=t.slice();for(var o=0;o<t.length;o++)e(t[o]);var c=n;return l(l.s=0)}([function(e,t,A){"use strict";A.r(t);A(1);var r=new URL(document.currentScript.src),n=r.href.substring(0,r.href.lastIndexOf("/libs")+1);A.p=n,Promise.all([A.e(2),A.e(1)]).then(function(){var e=[A(2),A(4),A(3),A(21),A(22),A(23),A(6),A(5),A(11),A(10),A(12),A(8),A(9),A(13),A(14),A(15),A(16),A(17),A(18),A(19),A(7),A(20)];(function(c,e,p,d,f,g,m,t,w,h,r,y,v,S,b,j,C,I,T,P,n,_){c(document).ready(function(){window.jStoreAppConfig=window.jStoreConfig?window.jStoreConfig:{},window.jStoreAppConfig.lang="string"==typeof window.jStoreAppConfig.lang?window.jStoreAppConfig.lang:"ru",window.jStoreEvents=window.jStoreEvents?window.jStoreEvents:[];var e=window.restaurant?window.restaurant:"";window.jStoreApp=g,window.jStoreApp.initEvents(window.jStoreEvents),window.jStoreStorage=m,window.jStoreAppConfig=c.extend({restaurant:e,terminalId:null,cityId:null,activePayments:[],defaultCategory:!1,h1InSection:!0,worldPayTestMode:100,server:{url:"https://deliverywiget.iiko.ru"},urls:{catalog:"",documentRoot:!1,siteAddress:!1},templates:[],formData:{},orderDateTimePickerItems:[],orderDateTimePickerConfig:{}},window.jStoreAppConfig);function l(e){e=e||'<p>Пожалуйста, проверьте <a target="_blank" href="http://jstore.me/instruction?sPage=index">настройки ресторана</a>, касающиеся указания переменной <b>window.restaurant</b> на странице виджета.</p>',c("#lsp-block-content").html(e)}g.declination;g.isGUID(window.jStoreAppConfig.restaurant)?c.ajax({url:window.jStoreAppConfig.server.url+"/Nomenclature/Nomenclature/"+window.jStoreAppConfig.restaurant,dataType:"json",data:{lang:window.jStoreAppConfig.lang},success:function(e){if(e.success){e.restarauntInfo.paymentTypes=e.paymentTypes,e.restarauntInfo.deliveryTerminals=e.deliveryTerminals,g.restaurant=new d(e.restarauntInfo);var t=A(24)("./"+window.jStoreAppConfig.lang);g.loc=new t(g.restaurant.get("localizations")),g.t=function(e,t){return g.loc.t(e,t)},g.getCurrency=function(){return g.restaurant.get("currency")};var r=new RegExp("[?&]{1}utm_source=([^(&|#)]+)").exec(window.location.search);if(r&&r.length&&m.setItem("utm_source",decodeURIComponent(r[1])),g.loadOnFetch=!0,g.filter=new j,g.user=new b,0===c(".lsp-block-terminalinfo").length&&m.setItem("terminal_id",!1,"initialize"),p.each(e.deliveryTerminals,function(e){e.id=e.iikoId}),g.lastPurchases=e.lastPurchases,g.DeliveryTerminals=new P(e.deliveryTerminals).setup(),g.DeliveryCities=new S(e.cities),g.DeliveryCities.setup(),e.marketingSourceInfos){var n=[];p.each(e.marketingSourceInfos,function(e){n.push({id:e.name,name:e.name,utmSource:e.utmSource?e.utmSource:e.name})}),n=p.sortBy(n,function(e){return e.name}),g.restaurant.set("marketingSourceInfo",n)}var o=g.getAllGroups(e.groups);g.tree=new y(o),g.dbItems=new v([],!0),g.dbTags=new _;var i={},s={};e.stopLists&&e.stopLists.items&&p.each(e.stopLists.items,function(t){p.each(t.items,function(e){s[e.productId]||(s[e.productId]={}),s[e.productId][t.deliveryTerminalId]=e.balance})}),p.each(e.products,function(o,a){!function(){o.imageId&&"00000000-0000-0000-0000-000000000000"!==o.imageId&&(o.smallImageUrl=g.restaurant.getUrl("imageDir")+"/"+o.imageId+"_Small_.png",o.mediumImageUrl=g.restaurant.getUrl("imageDir")+"/"+o.imageId+"_Medium_.png",o.largeImageUrl=g.restaurant.getUrl("imageDir")+"/"+o.imageId+"_Large_.png"),o.searchTags=[];var e=o.properties,t={};if(Array.isArray(e)&&e.every(function(e){return t[e.key]=e.value,!0}),o.properties=t,o.tags?p.each(o.tags,function(e){e.translitName=e.translitName.toLowerCase(),o.searchTags.push(e.translitName);var t=g.dbTags.get(e.translitName);t||(g.dbTags.push({id:e.translitName,name:e.name,translitName:e.translitName,className:"lsp-js-tag-select lsp-block-tags-filter-"+e.translitName}),t=g.dbTags.get(e.translitName)),t.addParentGroups(o.parentGroups)}):o.tags=[],s[o.id]?o.stopList=s[o.id]:o.stopList={},!0===o.useBalanceForSell){var r=g.tree.get(o.parentGroup),n=r?r.get("properties"):{};o.properties.weightGoodsStep?o.defaultCountStep=parseFloat(o.properties.weightGoodsStep):n.weightGoodsStep?o.defaultCountStep=parseFloat(n.weightGoodsStep):o.defaultCountStep=g.restaurant.get("weightedGoodStep"),o.properties.weightGoodsDefaultValue?o.defaultCount=parseFloat(o.properties.weightGoodsDefaultValue):n.weightGoodsDefaultValue?o.defaultCount=parseFloat(n.weightGoodsDefaultValue):o.defaultCount=g.restaurant.get("weightedGoodDefaultWeight")}else o.defaultCount=1,o.defaultCountStep=1;g.dbItems.push(o),i[o.id]=a}()}),g.dbTags.models.sort(function(e,t){return e.get("name")>t.get("name")}),g.upsaleCollection=e.upsaleCollection,g.cart=new h,g.loadCart(g.cart,JSON.parse(m.getItem("Cart","[]")),g.dbItems),g.cart.on("add change remove reset",function(){g.saveCart(this,m)}),g.order=new I,g.order.setEnvironment(m,g.filter,g.user,g.restaurant);var a=null,u=function(){a&&clearTimeout(a),a=setTimeout(function(){g.discountFetch(g.restaurant,g.cart,g.user,g.order,g.filter)},350)};g.restaurant.canPayDiscount()&&(g.cart.on("add change:amount change:terminal_id remove reset",u),g.order.on("change:phone change:name change:marketing_source change:coupon change:delivery_type",u),g.user.on("change:canHaveBonuses",u),u()),g.HappyHour=new C,e.happyHour&&(g.HappyHour.init(e.happyHour),g.HappyHour.on("change",u),u()),u(),g.main=new T,g.crumbs=new w,g.orderProducts=i,(new f).render()}else e.error?l(e.error):l()},error:function(){l()}}):l()})}).apply(null,e)}).catch(A.oe)},function(e,t,r){}])});